<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.31">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="Ph.D.&nbsp;Thesis, Center for Language and Cognition (CLCG), University of Groningen">

<title>Appendix A — Attributing Context Usage in Multilingual NLP – From Insights to Impact</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../chapters/appendix-b.html" rel="next">
<link href="../chapters/references.html" rel="prev">
<link href="../figures/logos/rug_crest_icon.png" rel="icon" type="image/png">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-e1a5c8363afafaef2c763b6775fbf3ca.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-df7dc7f297c6c2c740a551c3cb7e1581.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="../site_libs/quarto-contrib/pseudocode-2.4.1/pseudocode.min.js"></script>
<link href="../site_libs/quarto-contrib/pseudocode-2.4.1/pseudocode.min.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../html/custom.css">
</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../chapters/appendix-a.html">Appendices</a></li><li class="breadcrumb-item"><a href="../chapters/appendix-a.html"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Attributing Context Usage in Multilingual NLP</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="../index.html" class="sidebar-logo-link">
      <img src="../figures/logos/rug_eng_red_hat_line.png" alt="RUG Coat of Arms" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="../">From Insights to Impact</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/gsarti/phd-thesis" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-github"></i></a>
    <a href="https://gsarti.com" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-person-circle"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/chap-2-background.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Background</span></span></a>
  </div>
</li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Attributing Context Usage in Multilingual NLP</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/chap-3-inseq.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Attributing Language Model Generations with the Inseq Toolkit</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/chap-4-pecore.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Quantifying Context Usage in Neural Machine Translation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/chap-5-mirage.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Answer Attribution for Trustworthy Retrieval-Augmented Generation</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Conditioning Generation for Personalized Machine Translation</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/chap-6-ramp.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Retrieval and Marking for Attribute-Controlled Translation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/chap-7-sae-litmt.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Steering Language Models for Personalized Machine Translation</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Interpretability in Human Translation Workflows</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/chap-8-divemt.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Machine Translation Post-editing for Typologically Diverse Languages</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/chap-9-qe4pe.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Word-level Quality Estimation for Machine Translation Post-editing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/chap-10-unsup-wqe.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Unsupervised MT Error Detection and Human Disagreement</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/chap-11-conclusion.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Conclusion</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bibliography</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/appendix-a.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Attributing Context Usage in Multilingual NLP</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/appendix-b.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Conditioning Generation for Personalized Machine Translation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/appendix-c.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Interpretability in Human Translation Workflows</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#sec-inseq-appendix" id="toc-sec-inseq-appendix" class="nav-link active" data-scroll-target="#sec-inseq-appendix"><span class="header-section-number">A.1</span> Attributing Language Model Generations with the Inseq Toolkit</a>
  <ul class="collapse">
  <li><a href="#sec-inseq-appendix-turkish-gender-bias" id="toc-sec-inseq-appendix-turkish-gender-bias" class="nav-link" data-scroll-target="#sec-inseq-appendix-turkish-gender-bias"><span class="header-section-number">A.1.1</span> Additional Details on Turkish Gender Bias Case Study</a></li>
  <li><a href="#sec-inseq-appendix-pair-agg-gender-swap" id="toc-sec-inseq-appendix-pair-agg-gender-swap" class="nav-link" data-scroll-target="#sec-inseq-appendix-pair-agg-gender-swap"><span class="header-section-number">A.1.2</span> Example of Pair Aggregation for Contrastive MT Comparison</a></li>
  <li><a href="#sec-inseq-appendix-factual-knowledge" id="toc-sec-inseq-appendix-factual-knowledge" class="nav-link" data-scroll-target="#sec-inseq-appendix-factual-knowledge"><span class="header-section-number">A.1.3</span> Example of Quantized CAT Attribution</a></li>
  </ul></li>
  <li><a href="#sec-pecore-appendix" id="toc-sec-pecore-appendix" class="nav-link" data-scroll-target="#sec-pecore-appendix"><span class="header-section-number">A.2</span> Quantifying Context Usage in Neural Machine Translation</a>
  <ul class="collapse">
  <li><a href="#sec-pecore-appendix-eval-details" id="toc-sec-pecore-appendix-eval-details" class="nav-link" data-scroll-target="#sec-pecore-appendix-eval-details"><span class="header-section-number">A.2.1</span> Details on Translation Evaluation</a></li>
  <li><a href="#sec-pecore-appendix-cti-cci-results" id="toc-sec-pecore-appendix-cti-cci-results" class="nav-link" data-scroll-target="#sec-pecore-appendix-cti-cci-results"><span class="header-section-number">A.2.2</span> Full CTI and CCI Results</a></li>
  <li><a href="#sec-pecore-appendix-other-tasks" id="toc-sec-pecore-appendix-other-tasks" class="nav-link" data-scroll-target="#sec-pecore-appendix-other-tasks"><span class="header-section-number">A.2.3</span> <span class="smallcaps">PECoRe</span> for Other Language Generation Tasks</a></li>
  </ul></li>
  <li><a href="#sec-mirage-appendix" id="toc-sec-mirage-appendix" class="nav-link" data-scroll-target="#sec-mirage-appendix"><span class="header-section-number">A.3</span> Answer Attribution for Trustworthy Retrieval-Augmented Generation</a>
  <ul class="collapse">
  <li><a href="#sec-mirage-appendix-full-attribution" id="toc-sec-mirage-appendix-full-attribution" class="nav-link" data-scroll-target="#sec-mirage-appendix-full-attribution"><span class="header-section-number">A.3.1</span> Answer Attribution on the Full XOR-AttriQA</a></li>
  <li><a href="#sec-mirage-appendix-standard-prompt" id="toc-sec-mirage-appendix-standard-prompt" class="nav-link" data-scroll-target="#sec-mirage-appendix-standard-prompt"><span class="header-section-number">A.3.2</span> ELI5 Evaluation with Standard Prompt</a></li>
  <li><a href="#sec-mirage-appendix-more-cases" id="toc-sec-mirage-appendix-more-cases" class="nav-link" data-scroll-target="#sec-mirage-appendix-more-cases"><span class="header-section-number">A.3.3</span> More Examples of Disagreement</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../chapters/appendix-a.html">Appendices</a></li><li class="breadcrumb-item"><a href="../chapters/appendix-a.html"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Attributing Context Usage in Multilingual NLP</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span id="sec-appendix-a" class="quarto-section-identifier">Appendix A — Attributing Context Usage in Multilingual NLP</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="sec-inseq-appendix" class="level2" data-number="A.1">
<h2 data-number="A.1" class="anchored" data-anchor-id="sec-inseq-appendix"><span class="header-section-number">A.1</span> Attributing Language Model Generations with the Inseq Toolkit</h2>
<section id="sec-inseq-appendix-turkish-gender-bias" class="level3" data-number="A.1.1">
<h3 data-number="A.1.1" class="anchored" data-anchor-id="sec-inseq-appendix-turkish-gender-bias"><span class="header-section-number">A.1.1</span> Additional Details on Turkish Gender Bias Case Study</h3>
<p><a href="#tbl-turkish-wordlist" class="quarto-xref">Table&nbsp;<span>A.1</span></a> shows the list of occupation terms used in the gender bias case study (<a href="chap-3-inseq.html#sec-chap3-gender-bias" class="quarto-xref"><span>Section 3.3.1</span></a>). We correlate the ranking of occupations based on the selected attribution metrics and probabilities with U.S. labor statistics<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>. Table <a href="chap-3-inseq.html#tbl-chap3-m2m-gender-example" class="quarto-xref">Table&nbsp;<span>3.3</span></a> example was taken from the BUG dataset <span class="citation" data-cites="levy-etal-2021-collecting-large">(<a href="references.html#ref-levy-etal-2021-collecting-large" role="doc-biblioref">Levy et al., 2021</a>)</span>.</p>
<div id="tbl-turkish-wordlist" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<div aria-describedby="tbl-turkish-wordlist-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="center-table table" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"><strong>Turkish</strong></th>
<th class="rline" data-quarto-table-cell-role="th"><strong>English</strong></th>
<th data-quarto-table-cell-role="th"><strong>Turkish</strong></th>
<th class="rline" data-quarto-table-cell-role="th"><strong>English</strong></th>
<th data-quarto-table-cell-role="th"><strong>Turkish</strong></th>
<th data-quarto-table-cell-role="th"><strong>English</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>teknisyen</td>
<td class="rline">technician</td>
<td>memur</td>
<td class="rline">officer</td>
<td>muhasebeci</td>
<td>accountant</td>
</tr>
<tr class="even">
<td>patolog</td>
<td class="rline">pathologist</td>
<td>süpervizör</td>
<td class="rline">supervisor</td>
<td>öğretmen</td>
<td>teacher</td>
</tr>
<tr class="odd">
<td>mühendis</td>
<td class="rline">engineer</td>
<td>avukat</td>
<td class="rline">lawyer</td>
<td>işçi</td>
<td>worker</td>
</tr>
<tr class="even">
<td>planlamacı</td>
<td class="rline">planner</td>
<td>eğitimci</td>
<td class="rline">educator</td>
<td>yönetici</td>
<td>practitioner</td>
</tr>
<tr class="odd">
<td>katip</td>
<td class="rline">clerk</td>
<td>tesisatçı</td>
<td class="rline">plumber</td>
<td>danışman</td>
<td>consultant</td>
</tr>
<tr class="even">
<td>eğitmen</td>
<td class="rline">instructor</td>
<td>müfettiş</td>
<td class="rline">inspector</td>
<td>cerrah</td>
<td>surgeon</td>
</tr>
<tr class="odd">
<td>tamirci</td>
<td class="rline">mechanic</td>
<td>veteriner</td>
<td class="rline">veterinarian</td>
<td>müdür</td>
<td>manager</td>
</tr>
<tr class="even">
<td>kimyager</td>
<td class="rline">chemist</td>
<td>terapist</td>
<td class="rline">therapist</td>
<td>makinist</td>
<td>machinist</td>
</tr>
<tr class="odd">
<td>resepsiyonist</td>
<td class="rline">receptionist</td>
<td>mimar</td>
<td class="rline">architect</td>
<td>kütüphaneci</td>
<td>librarian</td>
</tr>
<tr class="even">
<td>kuaför</td>
<td class="rline">hairdresser</td>
<td>ressam</td>
<td class="rline">painter</td>
<td>fırıncı</td>
<td>baker</td>
</tr>
<tr class="odd">
<td>eczacı</td>
<td class="rline">pharmacist</td>
<td>programlamacı</td>
<td class="rline">programmer</td>
<td>kapıcı</td>
<td>janitor</td>
</tr>
<tr class="even">
<td>itfaiyeci</td>
<td class="rline">firefighter</td>
<td>psikolog</td>
<td class="rline">psychologist</td>
<td>bilim insanı</td>
<td>scientist</td>
</tr>
<tr class="odd">
<td>doktor</td>
<td class="rline">physician</td>
<td>sevk memuru</td>
<td class="rline">dispatcher</td>
<td>marangoz</td>
<td>carpenter</td>
</tr>
<tr class="even">
<td>kasiyer</td>
<td class="rline">cashier</td>
<td>hemşire</td>
<td class="rline">nurse</td>
<td>komisyoncu</td>
<td>broker</td>
</tr>
<tr class="odd">
<td>araştırmacı</td>
<td class="rline">investigator</td>
<td>şef</td>
<td class="rline">chef</td>
<td>barmen</td>
<td>bartender</td>
</tr>
<tr class="even">
<td>doktor</td>
<td class="rline">doctor</td>
<td>uzman</td>
<td class="rline">specialist</td>
<td>sekreter</td>
<td>secretary</td>
</tr>
<tr class="odd">
<td>elektrikçi</td>
<td class="rline">electrician</td>
<td></td>
<td class="rline"></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-tbl" id="tbl-turkish-wordlist-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;A.1: List of the 49 Turkish occupation terms and their English translations used in the gender bias case study.
</figcaption>
</figure>
</div>
</section>
<section id="sec-inseq-appendix-pair-agg-gender-swap" class="level3" data-number="A.1.2">
<h3 data-number="A.1.2" class="anchored" data-anchor-id="sec-inseq-appendix-pair-agg-gender-swap"><span class="header-section-number">A.1.2</span> Example of Pair Aggregation for Contrastive MT Comparison</h3>
<p>An example of gender translation pair using the synthetic template of <a href="chap-3-inseq.html#sec-chap3-gender-bias" class="quarto-xref"><span>Section 3.3.1</span></a> is show in <a href="#fig-ex-gender-pair-agg" class="quarto-xref">Figure&nbsp;<span>A.1</span></a>, highlighting a large drop in probability when switching the gendered pronoun for highly gender-stereotypical professions, similar to <a href="chap-3-inseq.html#tbl-chap3-turkish-gender-bias" class="quarto-xref">Table&nbsp;<span>3.2</span></a> results.</p>
<div id="fig-ex-gender-pair-agg" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ex-gender-pair-agg-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="sourceCode" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> inseq</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> inseq.data.aggregator <span class="im">import</span> <span class="op">*</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the TR-EN translation model and attach the IG method</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> inseq.load_model(</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Helsinki-NLP/opus-mt-tr-en"</span>, <span class="st">"integrated_gradients"</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Forced decoding. Return probabilities, no target attr.</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>out <span class="op">=</span> model.attribute(</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>    [<span class="st">"O bir teknisyen"</span>, <span class="st">"O bir teknisyen"</span>],</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>    [<span class="st">"She is a technician."</span>,<span class="st">"He is a technician."</span>],</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>    step_scores<span class="op">=</span>[<span class="st">"probability"</span>],</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregation pipeline composed by two steps:</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Aggregate subword tokens across all dimensions:</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Aggregate hidden size to produce token-level attributions</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>subw_aggregator <span class="op">=</span> AggregatorPipeline(</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>    [SubwordAggregator, SequenceAttributionAggregator]</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>masculine <span class="op">=</span> out[<span class="dv">0</span>].aggregate(aggregator<span class="op">=</span>subw_aggregator)</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>feminine <span class="op">=</span> out[<span class="dv">1</span>].aggregate(aggregator<span class="op">=</span>subw_aggregator)</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Take the diff of the scores of the two attributions</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>masculine.show(aggregator<span class="op">=</span>PairAggregator, paired_attr<span class="op">=</span>feminine)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../figures/chap-3-inseq/tr_en_pair_aggr_example.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:60.0%"></p>
</figure>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ex-gender-pair-agg-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;A.1: Comparing attributions for a synthetic Turkish-to-English translation example with underspecified source pronoun gender using a MarianMT Turkish-to-English translation model <span class="citation" data-cites="tiedemann-2020-tatoeba">(<a href="references.html#ref-tiedemann-2020-tatoeba" role="doc-biblioref">Tiedemann, 2020</a>)</span>. Values in the visualized attribution matrix show a 46% higher probability of producing the masculine pronoun in the translation and a relative decrease of 18.4% in the importance of the Turkish occupation term compared to the feminine pronoun case.
</figcaption>
</figure>
</div>
</section>
<section id="sec-inseq-appendix-factual-knowledge" class="level3" data-number="A.1.3">
<h3 data-number="A.1.3" class="anchored" data-anchor-id="sec-inseq-appendix-factual-knowledge"><span class="header-section-number">A.1.3</span> Example of Quantized CAT Attribution</h3>
<p><a href="#fig-ex-cat-counterfact-code" class="quarto-xref">Figure&nbsp;<span>A.2</span></a> presents code used in <a href="chap-3-inseq.html#sec-chap3-rome-repro" class="quarto-xref"><span>Section 3.3.2</span></a> case study, with visualized attribution scores for contrastive examples presented in <a href="#fig-chap3-ex-cat-counterfact-plots" class="quarto-xref">Figure&nbsp;<span>A.3</span></a>.</p>
<div id="fig-ex-cat-counterfact-code" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ex-cat-counterfact-code-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="sourceCode" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> inseq</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> datasets <span class="im">import</span> load_dataset</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> transformers <span class="im">import</span> AutoModelForCausalLM, AutoTokenizer</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co"># The model is loaded in 8-bit on available GPUs</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> AutoModelForCausalLM.from_pretrained(</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"gpt2-xl"</span>, load_in_8bit<span class="op">=</span><span class="va">True</span>, device_map<span class="op">=</span><span class="st">"auto"</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Counterfact datasets used by Meng et al. (2022)</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> load_dataset(<span class="st">"NeelNanda/counterfact-tracing"</span>)[<span class="st">"train"</span>]</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="co"># GPT-2 XL is a transformer model with 48 layers</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> layer <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">48</span>):</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>    attrib_model <span class="op">=</span> inseq.load_model(</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>        model,</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>        <span class="st">"layer_gradient_x_activation"</span>,</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>        tokenizer<span class="op">=</span><span class="st">"gpt2-xl"</span>,</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>        target_layer<span class="op">=</span>model.transformer.h[layer].mlp,</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, ex <span class="kw">in</span> data:</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>        <span class="co"># e.g. "The capital of Second Spanish Republic is"</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>        <span class="co"># -&gt; Madrid (true) / Paris (false)</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>        prompt <span class="op">=</span> ex[<span class="st">"relation"</span>].<span class="bu">format</span>(ex[<span class="st">"subject"</span>])</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>        true_answer <span class="op">=</span> prompt <span class="op">+</span> ex[<span class="st">"target_true"</span>]</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>        false_answer <span class="op">=</span> prompt <span class="op">+</span> ex[<span class="st">"target_false"</span>] </span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Contrastive attribution of true vs false answer</span></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>        out <span class="op">=</span> attrib_model.attribute(</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>            prompt,</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>            true_answer,</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>            attributed_fn<span class="op">=</span><span class="st">"contrast_prob_diff"</span>,</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>            contrast_targets<span class="op">=</span>false_answer,</span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>            show_progress<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>        )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ex-cat-counterfact-code-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;A.2: Example code to contrastively attribute factual statements from the Counterfact Tracing dataset, using Layer Gradient <span class="math inline">\(\times\)</span> Activation to compute importance scores until intermediate layers of the GPT2-XL model.
</figcaption>
</figure>
</div>
<div id="fig-chap3-ex-cat-counterfact-plots" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-chap3-ex-cat-counterfact-plots-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../figures/chap-3-inseq/cat_example_1.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../figures/chap-3-inseq/cat_example_2.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../figures/chap-3-inseq/cat_example_3.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../figures/chap-3-inseq/cat_example_4.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../figures/chap-3-inseq/cat_example_5.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../figures/chap-3-inseq/cat_example_6.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-chap3-ex-cat-counterfact-plots-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;A.3: Visualization of contrastive attribution scores on a subset of layers (23 to 48) for some selected dataset examples. Plot labels show the contrastive pairs of false <span class="math inline">\(\rightarrow\)</span> true answer used as attribution targets.
</figcaption>
</figure>
</div>
<p></p><div style="page-break-after: always;"></div> <p></p>
</section>
</section>
<section id="sec-pecore-appendix" class="level2" data-number="A.2">
<h2 data-number="A.2" class="anchored" data-anchor-id="sec-pecore-appendix"><span class="header-section-number">A.2</span> Quantifying Context Usage in Neural Machine Translation</h2>
<section id="sec-pecore-appendix-eval-details" class="level3" data-number="A.2.1">
<h3 data-number="A.2.1" class="anchored" data-anchor-id="sec-pecore-appendix-eval-details"><span class="header-section-number">A.2.1</span> Details on Translation Evaluation</h3>
<p>We compute BLEU using the SACREBLEU library <span class="citation" data-cites="post-2018-call">(<a href="references.html#ref-post-2018-call" role="doc-biblioref">Post, 2018</a>)</span> with default parameters <code>nrefs:1|case:mixed|eff:no|tok:13a|smooth:exp|version:2.3.1</code>. The models fine-tuned with source and target context clearly outperform the ones trained with source only, both in terms of generic translation quality and context-sensitive disambiguation accuracy. This motivates our choice to focus primarily on those models for our main analysis. All models are available in the following Huggingface organization: <a href="https://hf.co/context-mt" class="uri">https://hf.co/context-mt</a>. The <span class="math inline">\(S_{\text{ctx}}\)</span> models correspond to those matching <code>context-mt/scat-&lt;MODEL\_TYPE&gt;-ctx4-cwd1-en-fr</code>, while <span class="math inline">\(S+T_{\text{ctx}}\)</span> models have the <code>context-mt/scat-&lt;MODEL\_TYPE&gt;-target-ctx4-cwd0-en-fr</code> identifier.</p>
</section>
<section id="sec-pecore-appendix-cti-cci-results" class="level3" data-number="A.2.2">
<h3 data-number="A.2.2" class="anchored" data-anchor-id="sec-pecore-appendix-cti-cci-results"><span class="header-section-number">A.2.2</span> Full CTI and CCI Results</h3>
<p><a href="#fig-cti-f1-app" class="quarto-xref">Figure&nbsp;<span>A.4</span></a> and <a href="#fig-cti-auprc-app" class="quarto-xref">Figure&nbsp;<span>A.5</span></a> present the CTI plausibility of all tested models for the Macro F1 and AUPRC metrics, similarly to <a href="chap-4-pecore.html#fig-marian-big-f1-cti" class="quarto-xref">Figure&nbsp;<span>4.3</span></a> in the main analysis.</p>
<div id="fig-cti-f1-app" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-cti-f1-app-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../figures/chap-4-pecore/macro_f1_cti_marian-small-scat_box.webp" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:85.0%"></p>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../figures/chap-4-pecore/macro_f1_cti_marian-big-scat_box.webp" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:85.0%"></p>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../figures/chap-4-pecore/macro_f1_cti_mbart50-1toM-scat_box.webp" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:85.0%"></p>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../figures/chap-4-pecore/macro_f1_cti_marian-small-scat-target_box.webp" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:85.0%"></p>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../figures/chap-4-pecore/macro_f1_cti_marian-big-scat-target_box.webp" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:85.0%"></p>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../figures/chap-4-pecore/macro_f1_cti_mbart50-1toM-scat-target_box.webp" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:85.0%"></p>
</figure>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-cti-f1-app-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;A.4: Macro F1 of contrastive metrics for context-sensitive target token identification (CTI) on the full datasets (left) or on <span class="smallcaps">ok-cs</span> context-sensitive subsets (right). <strong>Top to bottom:</strong> ⓵ OpusMT Small S<span class="math inline">\(_\text{ctx}\)</span> ⓶ OpusMT Large S<span class="math inline">\(_\text{ctx}\)</span> ⓷ mBART-50 S<span class="math inline">\(_\text{ctx}\)</span> ⓸ OpusMT Small S+T<span class="math inline">\(_\text{ctx}\)</span> ⓹ OpusMT Large S+T<span class="math inline">\(_\text{ctx}\)</span> ⓺ mBART-50 S+T<span class="math inline">\(_\text{ctx}\)</span>.
</figcaption>
</figure>
</div>
<div id="fig-cti-auprc-app" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-cti-auprc-app-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../figures/chap-4-pecore/auprc_cti_marian-small-scat_box.webp" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:85.0%"></p>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../figures/chap-4-pecore/auprc_cti_marian-big-scat_box.webp" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:85.0%"></p>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../figures/chap-4-pecore/auprc_cti_mbart50-1toM-scat_box.webp" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:85.0%"></p>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../figures/chap-4-pecore/auprc_cti_marian-small-scat-target_box.webp" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:85.0%"></p>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../figures/chap-4-pecore/auprc_cti_marian-big-scat-target_box.webp" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:85.0%"></p>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../figures/chap-4-pecore/auprc_cti_mbart50-1toM-scat-target_box.webp" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:85.0%"></p>
</figure>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-cti-auprc-app-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;A.5: Area Under Precision-Recall Curve (AUPRC) of contrastive metrics for context-sensitive target token identification (CTI) on the full datasets (left) or on <span class="smallcaps">ok-cs</span> context-sensitive subsets (right). <strong>Top to bottom:</strong> ⓵ OpusMT Small S<span class="math inline">\(_\text{ctx}\)</span> ⓶ OpusMT Large S<span class="math inline">\(_\text{ctx}\)</span> ⓷ mBART-50 S<span class="math inline">\(_\text{ctx}\)</span> ⓸ OpusMT Small S+T<span class="math inline">\(_\text{ctx}\)</span> ⓹ OpusMT Large S+T<span class="math inline">\(_\text{ctx}\)</span> ⓺ mBART-50 S+T<span class="math inline">\(_\text{ctx}\)</span>.
</figcaption>
</figure>
</div>
<p><a href="#fig-cci-f1-app" class="quarto-xref">Figure&nbsp;<span>A.6</span></a> <a href="#fig-cci-auprc-app" class="quarto-xref">Figure&nbsp;<span>A.7</span></a> present the CCI plausibility of all tested models for the Macro F1 and AUPRC metrics, similarly to <a href="chap-4-pecore.html#fig-marian-big-f1-cci" class="quarto-xref">Figure&nbsp;<span>4.4</span></a> in the main analysis.</p>
<div id="fig-cci-f1-app" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-cci-f1-app-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../figures/chap-4-pecore/macro_f1_cci_marian-small-scat+tgt_box.webp" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../figures/chap-4-pecore/macro_f1_cci_marian-big-scat+tgt_box.webp" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../figures/chap-4-pecore/macro_f1_cci_mbart50-1toM-scat+tgt_box.webp" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-cci-f1-app-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;A.6: Macro F1 of CCI methods over full datasets using models trained with only source context (left) or with source+target context (right). Boxes and red median lines show CCI results based on gold context-sensitive tokens. Dotted bars show median CCI scores obtained from context-sensitive tokens identified by KL-Divergence during CTI (E2E settings). <strong>Top to bottom:</strong> ⓵ OpusMT Small S<span class="math inline">\(_\text{ctx}\)</span> and S+T<span class="math inline">\(_\text{ctx}\)</span> ⓶ OpusMT Large S<span class="math inline">\(_\text{ctx}\)</span> and S+T<span class="math inline">\(_\text{ctx}\)</span> ⓷ mBART-50 S<span class="math inline">\(_\text{ctx}\)</span> and S+T<span class="math inline">\(_\text{ctx}\)</span>.
</figcaption>
</figure>
</div>
<div id="fig-cci-auprc-app" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-cci-auprc-app-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../figures/chap-4-pecore/auprc_cci_marian-small-scat+tgt_box.webp" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../figures/chap-4-pecore/auprc_cci_marian-big-scat+tgt_box.webp" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../figures/chap-4-pecore/auprc_cci_mbart50-1toM-scat+tgt_box.webp" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-cci-auprc-app-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;A.7: Area Under Precision-Recall Curve (AUPRC) of CCI methods over full datasets using models trained with only source context (left) or with source+target context (right). Boxes and red median lines show CCI results based on gold context-sensitive tokens. Dotted bars show median CCI scores obtained from context-sensitive tokens identified by KL-Divergence during CTI (E2E settings). <strong>Top to bottom:</strong> ⓵ OpusMT Small S<span class="math inline">\(_\text{ctx}\)</span> and S+T<span class="math inline">\(_\text{ctx}\)</span> ⓶ OpusMT Large S<span class="math inline">\(_\text{ctx}\)</span> and S+T<span class="math inline">\(_\text{ctx}\)</span> ⓷ mBART-50 S<span class="math inline">\(_\text{ctx}\)</span> and S+T<span class="math inline">\(_\text{ctx}\)</span>.
</figcaption>
</figure>
</div>
</section>
<section id="sec-pecore-appendix-other-tasks" class="level3" data-number="A.2.3">
<h3 data-number="A.2.3" class="anchored" data-anchor-id="sec-pecore-appendix-other-tasks"><span class="header-section-number">A.2.3</span> <span class="smallcaps">PECoRe</span> for Other Language Generation Tasks</h3>
<p>This section complements our MT analysis and by demonstrating the applicability of <span class="smallcaps">PECoRe</span> to other model architectures and different language generation tasks. <a href="#tbl-zephyr-pecore" class="quarto-xref">Table&nbsp;<span>A.2</span></a> presents some examples. To generate the outputs, we use Zephyr Beta <span class="citation" data-cites="tunstall-etal-2023-zephyr">(<a href="references.html#ref-tunstall-etal-2023-zephyr" role="doc-biblioref">Tunstall et al., 2024</a>)</span>, a state-of-the-art conversational decoder-only language model with 7B parameters fine-tuned from the Mistral 7B v0.1 pre-trained model <span class="citation" data-cites="jiang-etal-2023-mistral">(<a href="references.html#ref-jiang-etal-2023-mistral" role="doc-biblioref">Jiang et al., 2023</a>)</span>. We follow the same setup of <a href="chap-4-pecore.html#sec-chap4-analysis" class="quarto-xref"><span>Section 4.5</span></a>, using KL-Divergence as CTI metric, <span class="math inline">\(\nabla_{\text{diff}}\)</span> as CCI method and setting both <span class="math inline">\(s_\text{CTI}\)</span> and <span class="math inline">\(s_\text{CCI}\)</span> to two standard deviations above the per-example mean.</p>
<p><span class="paragraph">Constrained Story Generation</span> In the first example, the model is asked to generate a story about , which is defined as a planet with an alien race only in context <span class="math inline">\(C_x\)</span>. We observe a plausible influence of several context components throughout the generation process, leading to a short story respecting the constraint specified in the system prompt provided as context.</p>
<p><span class="paragraph">Factual Question Answering</span> In the second example, the model is asked to retrieve date information from the context and perform a calculation to derive the age of a fictional building. While the non-contextual generation <span class="math inline">\(\tilde y\)</span> hallucinates an age and a construction date associated to a real historical landmark, contextual generation <span class="math inline">\(\hat y\)</span> produces a wrong age, but plausibly relies on the date provided in <span class="math inline">\(C_x\)</span> during generation. Interestingly, we can also identify when the system instruction of “keeping answers concise” intervenes during generation.</p>
<p><span class="paragraph">Information Extraction</span> The last example simulates a retrieval-augmented generation scenario in which a fictional refund policy is used as context to answer user queries. In this scenario, contextual generation <span class="math inline">\(\hat y\)</span> correctly identifies the user query as leading to a no-refund situation due to the limited refund timeline stated in the policy, and the corresponding timeline () is identified as a contextual cue leading to the model’s negative response.</p>
<div id="tbl-zephyr-pecore" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<div aria-describedby="tbl-zephyr-pecore-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="fullwidthtable leftalign table" data-quarto-postprocess="true">
<tbody>
<tr class="bottomrule odd">
<td><strong>Constrained Story Generation</strong></td>
</tr>
<tr class="even">
<td><span class="math inline">\(C_x\)</span>: <code>&lt;|system|&gt;</code> Here is some context about <span class="light-content" style="border-radius: 0.2rem; padding: 0 0.2rem 0 0.2rem;background-color: #9fc5e8;">planet</span>⓵⓶ Florbz. It is inhabited by a race of aliens called <span class="light-content" style="border-radius: 0.2rem; padding: 0 0.2rem 0 0.2rem;background-color: #9fc5e8;">Squortz</span>⓷, which <span class="light-content" style="border-radius: 0.2rem; padding: 0 0.2rem 0 0.2rem;background-color: #9fc5e8;">communicate</span>⓸ only by saying <span class="light-content" style="border-radius: 0.2rem; padding: 0 0.2rem 0 0.2rem;background-color: #9fc5e8;">‘Qiz!’</span>⓹ <code>&lt;/s&gt;</code></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(x\)</span>: <strong><code>&lt;|user|&gt;</code> Tell me a very short story about Florbz <code>&lt;/s&gt;</code> <code>&lt;|assistant|&gt;</code></strong></td>
</tr>
<tr class="even">
<td><span class="math inline">\(\tilde y\)</span>: Florbz was a curious little creature, half flower and half buzzing bee. He loved nothing more than exploring the garden he called home, flitting from bloom to bloom, spreading pollen as he went. <code>&lt;/s&gt;</code></td>
</tr>
<tr class="midrule odd">
<td><span class="math inline">\(\hat y\)</span>: On the <span class="light-content" style="border-radius: 0.2rem; padding: 0 0.2rem 0 0.2rem;background-color: #b6d7a8;">vibrant</span>⓵ and <span class="light-content" style="border-radius: 0.2rem; padding: 0 0.2rem 0 0.2rem;background-color: #b6d7a8;">colorful planet</span>⓶ of Florbz lived a curious creature named Zorg. He was different from his fellow <span class="light-content" style="border-radius: 0.2rem; padding: 0 0.2rem 0 0.2rem;background-color: #b6d7a8;">Squortz</span>⓷ as he longed to <span class="light-content" style="border-radius: 0.2rem; padding: 0 0.2rem 0 0.2rem;background-color: #b6d7a8;">learn their language</span>⓸ beyond just <span class="light-content" style="border-radius: 0.2rem; padding: 0 0.2rem 0 0.2rem;background-color: #b6d7a8;">‘Qiz!’</span>⓹ <code>&lt;/s&gt;</code></td>
</tr>
<tr class="bottomrule even">
<td><strong>Factual Question Answering</strong></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(C_x\)</span>: <code>&lt;|system|&gt;</code> Provide a concise answer containing only <span class="light-content" style="border-radius: 0.2rem; padding: 0 0.2rem 0 0.2rem;background-color: #9fc5e8;">few words</span>⓵<code>&lt;/s&gt;</code> <code>&lt;|user|&gt;</code> In the heart of Groningen, nestled between quaint cobbled streets and the meandering canals, stands the Pannekoekenkerk, a structure as rich in history as it is in legend. Built in <span class="light-content" style="border-radius: 0.2rem; padding: 0 0.2rem 0 0.2rem;background-color: #9fc5e8;">1877</span>⓵⓶, this peculiarly named ‘Pancake Church’ was once a humble bakery, famed for its delectable pannekoeken, which drew patrons from all corners of the Netherlands. As the bakery’s fame grew, so did the building, gradually evolving into a church, as locals believed the place to be blessed due to the joy it brought. Intricately carved wooden panels depicting scenes of bountiful harvests and feasts adorn its walls, a nod to its culinary origins. Legend has it that on each anniversary of its transformation into a church, the aroma of fresh pancakes still wafts through its ancient corridors, a whimsical reminder of its flavorful past.</td>
</tr>
<tr class="even">
<td><span class="math inline">\(x\)</span>: <strong>Question: How old is the Pannekoekenkerk in Groningen?<code>&lt;/s&gt;</code> <code>&lt;|assistant|&gt;</code></strong></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\tilde y\)</span>: Answer: 478 (1428) Explanation: The correct answer should be ‘How old is the Martinitoren tower in Groningen?’ instead, as it is actually the oldest building in the city, dating back to around 1428 AD <code>&lt;/s&gt;</code></td>
</tr>
<tr class="midrule even">
<td><span class="math inline">\(\hat y\)</span>: The Pannekoekenkerk in Groningen is <span class="light-content" style="border-radius: 0.2rem; padding: 0 0.2rem 0 0.2rem;background-color: #b6d7a8;">143</span>⓵ years old (built in <span class="light-content" style="border-radius: 0.2rem; padding: 0 0.2rem 0 0.2rem;background-color: #b6d7a8;">1877</span>⓶). <code>&lt;/s&gt;</code></td>
</tr>
<tr class="bottomrule odd">
<td><strong>Information Extraction</strong></td>
</tr>
<tr class="even">
<td><span class="math inline">\(C_x\)</span>: <code>&lt;|system|&gt;</code> Fictional Clothing Refund <span class="light-content" style="border-radius: 0.2rem; padding: 0 0.2rem 0 0.2rem;background-color: #9fc5e8;">Policy</span>⓶</td>
</tr>
<tr class="odd">
<td></td>
</tr>
<tr class="even">
<td>Effective Date: November 15th, 2023</td>
</tr>
<tr class="odd">
<td></td>
</tr>
<tr class="even">
<td>General Policy:</td>
</tr>
<tr class="odd">
<td>At Fictional Clothing, your satisfaction is our priority. We offer a hassle-free refund policy for our customers. If you’re not completely satisfied with your purchase, you can return it for a refund or exchange <span class="light-content" style="border-radius: 0.2rem; padding: 0 0.2rem 0 0.2rem;background-color: #9fc5e8;">within 30 days</span>⓵⓷ of purchase.</td>
</tr>
<tr class="even">
<td></td>
</tr>
<tr class="odd">
<td>Conditions for Refund:</td>
</tr>
<tr class="even">
<td></td>
</tr>
<tr class="odd">
<td>Items must be returned in original condition: Unworn, unwashed, with all tags attached.</td>
</tr>
<tr class="even">
<td>Proof of purchase required: A valid receipt or order number is necessary for all refunds or exchanges.</td>
</tr>
<tr class="odd">
<td>Refund method: Refunds will be issued to the original method of payment.</td>
</tr>
<tr class="even">
<td>Final sale items can be refunded only if they are returned in-store.</td>
</tr>
<tr class="odd">
<td></td>
</tr>
<tr class="even">
<td>Non-Refundable Items:</td>
</tr>
<tr class="odd">
<td></td>
</tr>
<tr class="even">
<td>Ultimate sale items: Products marked as ‘Ultimate Sale’ cannot be returned or exchanged</td>
</tr>
<tr class="odd">
<td>Personalized items: Custom-made or personalized items are non-refundable.</td>
</tr>
<tr class="even">
<td>Gift cards: Purchased gift cards are not eligible for a refund.</td>
</tr>
<tr class="odd">
<td></td>
</tr>
<tr class="even">
<td>Online Purchases:</td>
</tr>
<tr class="odd">
<td></td>
</tr>
<tr class="even">
<td>Return shipping: Customers are responsible for return shipping costs.</td>
</tr>
<tr class="odd">
<td>Processing time: Refunds will be processed within 7-10 business days of receiving the returned item.</td>
</tr>
<tr class="even">
<td></td>
</tr>
<tr class="odd">
<td>In-Store Purchases:</td>
</tr>
<tr class="even">
<td></td>
</tr>
<tr class="odd">
<td>Return to any store: Items purchased in-store can be returned to any of our retail locations.</td>
</tr>
<tr class="even">
<td>Instant refund: In-store returns will be processed immediately.</td>
</tr>
<tr class="odd">
<td></td>
</tr>
<tr class="even">
<td>Exchange Policy:</td>
</tr>
<tr class="odd">
<td></td>
</tr>
<tr class="even">
<td>Size or color exchange: Items can be exchanged for a different size or color, subject to availability.</td>
</tr>
<tr class="odd">
<td>In-store exchange: For faster service, we recommend exchanging items at any of our retail locations.</td>
</tr>
<tr class="even">
<td></td>
</tr>
<tr class="odd">
<td>Damaged or Defective Items:</td>
</tr>
<tr class="even">
<td></td>
</tr>
<tr class="odd">
<td>Report immediately: Please contact our customer service if you receive a damaged or defective item.</td>
</tr>
<tr class="even">
<td>Full refund or exchange: We will offer a full refund or exchange for such items.</td>
</tr>
<tr class="odd">
<td></td>
</tr>
<tr class="even">
<td>Changes to Refund Policy:</td>
</tr>
<tr class="odd">
<td>Fictional Clothing reserves the right to amend this refund policy at any time.</td>
</tr>
<tr class="even">
<td></td>
</tr>
<tr class="odd">
<td>Contact Us:</td>
</tr>
<tr class="even">
<td>For more information or assistance with returns, please contact our customer service team. <code>&lt;/s&gt;</code></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(x\)</span>: <strong><code>&lt;|user|&gt;</code> I have an unworn item that I bought two months ago and that I would like to return at one of your locations. Is it possible for me to get reimbursed? <code>&lt;/s&gt;</code> <code>&lt;|assistant|&gt;</code></strong></td>
</tr>
<tr class="even">
<td><span class="math inline">\(\tilde y\)</span>: The availability of returns and refunds may vary by the specific store or retailer you purchased from, so it’s best to check their return policy. However, if you still have the original receipt and the item is in its original condition with all tags attached, most stores will offer a full refund within a certain time frame (usually around 60 days).</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\hat y\)</span>: Since your purchase was made two months ago, <span class="light-content" style="border-radius: 0.2rem; padding: 0 0.2rem 0 0.2rem;background-color: #b6d7a8;">unfortunately</span>⓵, it falls outside our <span class="light-content" style="border-radius: 0.2rem; padding: 0 0.2rem 0 0.2rem;background-color: #b6d7a8;">policy’s</span>⓶ <span class="light-content" style="border-radius: 0.2rem; padding: 0 0.2rem 0 0.2rem;background-color: #b6d7a8;">30</span>⓷ days timeline for returns.</td>
</tr>
</tbody>
</table>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-tbl" id="tbl-zephyr-pecore-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;A.2: Examples of <span class="light-content" style="border-radius: 0.2rem; padding: 0 0.2rem 0 0.2rem;background-color: #9fc5e8;">cue</span>-<span class="light-content" style="border-radius: 0.2rem; padding: 0 0.2rem 0 0.2rem;background-color: #b6d7a8;">target</span> pairs (identified by indices) extracted by <span class="smallcaps">PECoRe</span> for the outputs of Zephyr 7B Beta across several language generation tasks. Model input <span class="math inline">\(x\)</span> is provided without context to produce non-contextual generation <span class="math inline">\(\tilde y\)</span>, or chained to preceding context <span class="math inline">\(C_x\)</span> to generate the contextual output <span class="math inline">\(\hat y\)</span> used by <span class="smallcaps">PECoRe</span>.
</figcaption>
</figure>
</div>
<p></p><div style="page-break-after: always;"></div> <p></p>
</section>
</section>
<section id="sec-mirage-appendix" class="level2" data-number="A.3">
<h2 data-number="A.3" class="anchored" data-anchor-id="sec-mirage-appendix"><span class="header-section-number">A.3</span> Answer Attribution for Trustworthy Retrieval-Augmented Generation</h2>
<section id="sec-mirage-appendix-full-attribution" class="level3" data-number="A.3.1">
<h3 data-number="A.3.1" class="anchored" data-anchor-id="sec-mirage-appendix-full-attribution"><span class="header-section-number">A.3.1</span> Answer Attribution on the Full XOR-AttriQA</h3>
<p>Differently from the concatenation setup in <a href="chap-5-mirage.html" class="quarto-xref"><span>Chapter 5</span></a>, we also test <span class="smallcaps">Mirage</span> on the full XOR-AttriQA dataset by constraining CORA generation to match the annotated answer <span class="math inline">\(\mathbf{y}\)</span>. We adopt a procedure similar to <span class="citation" data-cites="muller-etal-2023-evaluating">Muller et al. (<a href="references.html#ref-muller-etal-2023-evaluating" role="doc-biblioref">2023</a>)</span> by considering a single document-answer pair <span class="math inline">\((\text{doc}_i, \mathbf{y})\)</span> at a time, and using <span class="smallcaps">Mirage</span>’s CTI step to detect whether <span class="math inline">\(\mathbf{y}\)</span> is sensitive to the context <span class="math inline">\(\text{doc}_i\)</span>. Results in <a href="#tbl-cti-agreement" class="quarto-xref">Table&nbsp;<span>A.3</span></a> show that <span class="smallcaps">Mirage</span> achieves performances in line with other AA methods despite these approaches employing ad-hoc validators trained with as many as 540B parameters.</p>
<div id="tbl-cti-agreement" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<div aria-describedby="tbl-cti-agreement-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="center-table table" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"><strong>Method</strong></th>
<th data-quarto-table-cell-role="th"><strong>Extra Requirements</strong></th>
<th data-quarto-table-cell-role="th"><strong>BN</strong></th>
<th data-quarto-table-cell-role="th"><strong>FI</strong></th>
<th data-quarto-table-cell-role="th"><strong>JA</strong></th>
<th data-quarto-table-cell-role="th"><strong>RU</strong></th>
<th data-quarto-table-cell-role="th"><strong>TE</strong></th>
<th data-quarto-table-cell-role="th"><strong>Avg. / Std</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td rowspan="3" class="rowspan">mT5 XXL<span class="math inline">\(_{\text{NLI}}\)</span></td>
<td>11B NLI model (250 FT ex.)</td>
<td>81.9</td>
<td>80.9</td>
<td>94.5</td>
<td>87.1</td>
<td>88.7</td>
<td>86.6 / 4.9</td>
</tr>
<tr class="even">
<td>11B NLI model (100k FT ex.)</td>
<td>89.4</td>
<td>88.3</td>
<td>91.5</td>
<td>91.0</td>
<td>92.4</td>
<td>90.5 / 1.5</td>
</tr>
<tr class="midrule odd">
<td>11B NLI model (1M FT ex.)</td>
<td>91.1</td>
<td>90.4</td>
<td>93.0</td>
<td>92.9</td>
<td>93.8</td>
<td>92.2 / 1.3</td>
</tr>
<tr class="even">
<td class="namerow">PALM2<span class="math inline">\(_{\text{LORA}}\)</span></td>
<td>540B LLM (250 FT ex.)</td>
<td>91.5</td>
<td>88.3</td>
<td>94.7</td>
<td>93.7</td>
<td>93.7</td>
<td class="mediumrow">92.4 / 2.3</td>
</tr>
<tr class="odd">
<td class="namerow">PALM2<span class="math inline">\(_{\text{ex}}\)</span></td>
<td>540B LLM (250 FT ex.)</td>
<td class="bold">92.3</td>
<td class="bold">92.6</td>
<td class="bold">96.4</td>
<td class="bold">94.5</td>
<td class="bold">94.8</td>
<td class="mediumrow"><span class="bold">94.1</span> / 1.5</td>
</tr>
<tr class="even">
<td class="namerow">PALM2<span class="math inline">\(_{\text{ex}}\)</span></td>
<td>540B LLM (4-shot prompting)</td>
<td>91.5</td>
<td>87.4</td>
<td>92.0</td>
<td>90.5</td>
<td>90.6</td>
<td class="mediumrow">90.4 / 1.6</td>
</tr>
<tr class="midrule odd">
<td class="namerow">PALM2<span class="math inline">\(_{\text{CoT}}\)</span></td>
<td>540B LLM (4-shot prompting)</td>
<td>83.7</td>
<td>78.8</td>
<td>71.7</td>
<td>81.9</td>
<td>84.7</td>
<td class="mediumrow">80.2 / 4.7</td>
</tr>
<tr class="even">
<td><span class="smallcaps">Mirage</span><span class="math inline">\(_{\text{cal}}\)</span> (Ours)</td>
<td class="namerow">500 AA calibration ex.</td>
<td class="underline">82.2</td>
<td class="underline">82.5</td>
<td class="underline">92.0</td>
<td class="underline">87.7</td>
<td class="underline">90.2</td>
<td><u>86.9</u> / 4.0</td>
</tr>
<tr class="odd">
<td><span class="smallcaps">Mirage</span><span class="math inline">\(_{\text{ex}}\)</span> (Ours)</td>
<td class="namerow">--</td>
<td>79.0</td>
<td>74.1</td>
<td>90.8</td>
<td>82.6</td>
<td>86.9</td>
<td>82.7 / 5.8</td>
</tr>
</tbody>
</table>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-tbl" id="tbl-cti-agreement-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;A.3: Agreement % of <span class="smallcaps">Mirage</span> and entailment-based baselines with human AA on the full XOR-AttriQA using CORA for RAG (annotated answers not matching the LM’s natural generation are force-decoded). <strong>Extra Requirements</strong>: data/models needed for AA in addition to the RAG model itself. <strong>Best overall</strong> and best validator-free scores are highlighted. PALM and mT5 results are taken from <span class="citation" data-cites="muller-etal-2023-evaluating">Muller et al. (<a href="references.html#ref-muller-etal-2023-evaluating" role="doc-biblioref">2023</a>)</span>.
</figcaption>
</figure>
</div>
</section>
<section id="sec-mirage-appendix-standard-prompt" class="level3" data-number="A.3.2">
<h3 data-number="A.3.2" class="anchored" data-anchor-id="sec-mirage-appendix-standard-prompt"><span class="header-section-number">A.3.2</span> ELI5 Evaluation with Standard Prompt</h3>
<div id="tbl-prompts" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<div aria-describedby="tbl-prompts-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="fullwidthtable leftalign table" data-quarto-postprocess="true">
<tbody>
<tr class="bottomrule odd">
<td><span class="smallcaps">Self-citation</span> <span class="citation" data-cites="gao-etal-2023-enabling">(<a href="references.html#ref-gao-etal-2023-enabling" role="doc-biblioref">Gao et al., 2023</a>)</span></td>
</tr>
<tr class="midrule even">
<td><strong>Instruction:</strong> Write an accurate, engaging, and concise answer for the given question using only the provided search results (some of which might be irrelevant) and cite them properly. Use an unbiased and journalistic tone. Always cite for any factual claim. When citing several search results, use [1][2][3]. Cite at least one document and at most three documents in each sentence. If multiple documents support the sentence, only cite a minimum sufficient subset of the documents.</td>
</tr>
<tr class="bottomrule odd">
<td><span class="smallcaps">Standard</span></td>
</tr>
<tr class="even">
<td><strong>Instruction:</strong> Write an accurate, engaging, and concise answer for the given question using only the provided search results (some of which might be irrelevant). Use an unbiased and journalistic tone.</td>
</tr>
</tbody>
</table>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-tbl" id="tbl-prompts-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;A.4: Self-citation prompt, taken from <span class="citation" data-cites="gao-etal-2023-enabling">Gao et al. (<a href="references.html#ref-gao-etal-2023-enabling" role="doc-biblioref">2023</a>)</span>, and standard prompt with no citation instruction.
</figcaption>
</figure>
</div>
<p>In the main experiments, we use self-citation prompts by <span class="citation" data-cites="gao-etal-2023-enabling">Gao et al. (<a href="references.html#ref-gao-etal-2023-enabling" role="doc-biblioref">2023</a>)</span> for <span class="smallcaps">Mirage</span> answer attribution to control for the effect of different prompts on model responses, enabling a direct comparison with self-citation. In <a href="#tbl-eli5-full-results" class="quarto-xref">Table&nbsp;<span>A.5</span></a>, we provide additional results where a standard prompt without citation instructions is used (“Standard” prompt in <a href="#tbl-prompts" class="quarto-xref">Table&nbsp;<span>A.4</span></a>). We observe the overall citation quality of <span class="smallcaps">Mirage</span> drops when a standard prompt is used instead of self-citation instructions. We conjecture this might be due to answers that are, in general, less attributable to the provided context due to a lack of explicit instructions to do so. We also observe higher correctness and fluency in the standard prompt setting, suggesting a trade-off between answer and citation quality.</p>
<div id="tbl-eli5-full-results" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<div aria-describedby="tbl-eli5-full-results-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="center-table table" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th rowspan="2" data-quarto-table-cell-role="th"><strong>Model</strong></th>
<th rowspan="2" data-quarto-table-cell-role="th"><strong>Prompt</strong></th>
<th rowspan="2" data-quarto-table-cell-role="th"><strong>Answer Attribution</strong></th>
<th rowspan="2" data-quarto-table-cell-role="th"><strong>Filter</strong></th>
<th colspan="3" class="group-header" data-quarto-table-cell-role="th"><strong>Citation</strong></th>
<th rowspan="2" data-quarto-table-cell-role="th"><strong>Corr.</strong> <span class="math inline">\(\uparrow\)</span></th>
<th rowspan="2" data-quarto-table-cell-role="th"><strong>Fluency</strong> <span class="math inline">\(\uparrow\)</span></th>
</tr>
<tr class="subheader even">
<th data-quarto-table-cell-role="th">Prec.</th>
<th data-quarto-table-cell-role="th">Rec.</th>
<th data-quarto-table-cell-role="th">F1</th>
</tr>
</thead>
<tbody>
<tr class="midrule odd">
<td rowspan="5" class="rowspan">Zephyr</td>
<td rowspan="3" class="rowspan">Self-citation</td>
<td class="smallrow">Self-citation</td>
<td>--</td>
<td>41.4</td>
<td>24.3</td>
<td>30.6</td>
<td rowspan="3" class="rowspan">9.9</td>
<td rowspan="3" class="rowspan">28.6</td>
</tr>
<tr class="even">
<td rowspan="2" class="rowspan"><span class="smallcaps">Mirage</span><span class="math inline">\(_{\text{ex}}\)</span></td>
<td class="smallrow">Top 3</td>
<td>38.3</td>
<td>46.2</td>
<td>41.9</td>
</tr>
<tr class="midrule odd">
<td>Top 5%</td>
<td class="bold">44.7</td>
<td class="bold">46.5</td>
<td class="bold">45.6</td>
</tr>
<tr class="even">
<td rowspan="2" class="rowspan">Standard</td>
<td rowspan="2" class="rowspan"><span class="smallcaps">Mirage</span><span class="math inline">\(_{\text{ex}}\)</span></td>
<td>Top 3</td>
<td>29.8</td>
<td>34.5</td>
<td>32.0</td>
<td rowspan="2" class="bold rowspan">11.3</td>
<td rowspan="2" class="bold rowspan">34.3</td>
</tr>
<tr class="midrule odd">
<td>Top 5%</td>
<td>34.1</td>
<td>34.2</td>
<td>34.1</td>
</tr>
<tr class="midrule even">
<td rowspan="5" class="rowspan">LLaMA</td>
<td rowspan="3" class="rowspan">Self-citation</td>
<td>Self-citation</td>
<td>--</td>
<td class="bold">37.9</td>
<td>19.8</td>
<td>26.0</td>
<td rowspan="3" class="rowspan">11.8</td>
<td rowspan="3" class="rowspan">24.8</td>
</tr>
<tr class="odd">
<td rowspan="2" class="rowspan"><span class="smallcaps">Mirage</span><span class="math inline">\(_{\text{ex}}\)</span></td>
<td>Top 3</td>
<td>21.8</td>
<td class="bold">29.6</td>
<td>25.1</td>
</tr>
<tr class="midrule even">
<td>Top 5%</td>
<td>26.2</td>
<td>29.1</td>
<td class="bold">27.6</td>
</tr>
<tr class="odd">
<td rowspan="2" class="rowspan">Standard</td>
<td rowspan="2" class="rowspan"><span class="smallcaps">Mirage</span><span class="math inline">\(_{\text{ex}}\)</span></td>
<td>Top 3</td>
<td>17.8</td>
<td>20.9</td>
<td>19.2</td>
<td rowspan="2" class="rowspan bold">13.0</td>
<td rowspan="2" class="rowspan bold">26.4</td>
</tr>
<tr class="even">
<td>Top 5%</td>
<td>21.1</td>
<td>20.1</td>
<td>20.6</td>
</tr>
</tbody>
</table>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-tbl" id="tbl-eli5-full-results-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;A.5: Citation quality (F1, Recall, Precision), correctness (Corr.), and fluency of self-citation and <span class="smallcaps">Mirage</span> on ELI5 when using self-citation instruction and standard prompts of <a href="#tbl-prompts" class="quarto-xref">Table&nbsp;<span>A.4</span></a>.
</figcaption>
</figure>
</div>
</section>
<section id="sec-mirage-appendix-more-cases" class="level3" data-number="A.3.3">
<h3 data-number="A.3.3" class="anchored" data-anchor-id="sec-mirage-appendix-more-cases"><span class="header-section-number">A.3.3</span> More Examples of Disagreement</h3>
<p><a href="#tbl-case-study-3" class="quarto-xref">Table&nbsp;<span>A.6</span></a>, <a href="#tbl-case-study-5" class="quarto-xref">Table&nbsp;<span>A.7</span></a> and <a href="#tbl-case-study-6" class="quarto-xref">Table&nbsp;<span>A.8</span></a> show three cases where <span class="smallcaps">Mirage</span> answer attributions disagree with self-citation attributions of the same generation.<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> We adopt the Top-5% threshold for CCI Filtering. In <a href="#tbl-case-study-3" class="quarto-xref">Table&nbsp;<span>A.6</span></a>, the generated answer becomes the consistent description `cancel the alarm’ as mentioned in Document [3]. In this case, <span class="smallcaps">Mirage</span> attributes this sentence to the corresponding Document [3] while NLI maintains its attribution of Document [3] due to lexical overlap, as suggested in <a href="chap-5-mirage.html" class="quarto-xref"><span>Chapter 5</span></a>.</p>
<div id="tbl-case-study-3" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<div aria-describedby="tbl-case-study-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="fullwidthtable leftalign table" data-quarto-postprocess="true">
<tbody>
<tr class="bottomrule odd">
<td><span class="smallcaps">Input: Prompt + Retrieved docs (N=5) + Query</span></td>
</tr>
<tr class="even">
<td><strong>Document [2]</strong> […]</td>
</tr>
<tr class="odd">
<td><strong>Document [3]</strong> […] What will happen if you accidentally set off your security system? The siren will sound and it will be loud, but you should be able to stop the siren by entering your code into your keypad. […] You may also receive a call from the response center, checking to see if it is an actual alarm or a false alarm. You simply need to cancel the alarm with the response center by telling them your password (different from your keypad code). […]</td>
</tr>
<tr class="even">
<td><strong>Document [4]</strong> […]</td>
</tr>
<tr class="midrule odd">
<td><strong>Query</strong>: How does a small paper library bar code set off the security alarm when you haven’t checked a book out.</td>
</tr>
<tr class="bottomrule even">
<td><span class="smallcaps">Answer attribution results</span></td>
</tr>
<tr class="odd">
<td><strong>Self-citation</strong>: […] The response center may contact the individual to confirm if it’s a false alarm, and the individual can cancel the alarm by providing their password at the keypad. <span class="light-content" style="color: blue;">[<span class="math inline">\(\varnothing\)</span>]</span> […]</td>
</tr>
<tr class="even">
<td><strong><span class="smallcaps">Mirage</span></strong>: … The response <span class="light-content" style="border-radius: 0.2rem; padding: 0 0.2rem 0 0.2rem;background-color: yellow;">center</span><span class="math inline">\(^{(3)}\)</span> <span class="light-content" style="border-radius: 0.2rem; padding: 0 0.2rem 0 0.2rem;background-color: yellow;">may</span><span class="math inline">\(^{(3)}\)</span> contact the individual to confirm if <span class="light-content" style="border-radius: 0.2rem; padding: 0 0.2rem 0 0.2rem;background-color: yellow;">it</span><span class="math inline">\(^{(3)}\)</span>’s a false alarm, and the <span class="light-content" style="border-radius: 0.2rem; padding: 0 0.2rem 0 0.2rem;background-color: yellow;">individual</span><span class="math inline">\(^{(3)}\)</span> can <span class="light-content" style="border-radius: 0.2rem; padding: 0 0.2rem 0 0.2rem;background-color: yellow;">cancel</span><span class="math inline">\(^{(3)}\)</span> the alarm by <span class="light-content" style="border-radius: 0.2rem; padding: 0 0.2rem 0 0.2rem;background-color: yellow;">providing</span><span class="math inline">\(^{(3)}\)</span> their password at the <span class="light-content" style="border-radius: 0.2rem; padding: 0 0.2rem 0 0.2rem;background-color: yellow;">keypad</span><span class="math inline">\(^{(3)}\)</span>. <span class="light-content" style="color: blue;">[3]</span> …</td>
</tr>
<tr class="odd">
<td><strong>NLI (<span class="smallcaps">True</span> model)</strong>: <span class="light-content" style="color: blue;">[3]</span> entails the answer sentence.</td>
</tr>
</tbody>
</table>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-tbl" id="tbl-case-study-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;A.6: Example described in <a href="chap-5-mirage.html" class="quarto-xref"><span>Chapter 5</span></a>: <span class="smallcaps">Mirage</span> attributes the generation to Document [3] when <em>cancel</em> is used instead of <em>prevent</em>.
</figcaption>
</figure>
</div>
<p>On several occasions, we observe that <span class="smallcaps">Mirage</span> attributes all occurrences of lexically similar tokens in the context when the LLM is generating the same word. For example, in <a href="#tbl-case-study-5" class="quarto-xref">Table&nbsp;<span>A.7</span></a> the named entity “Science ABC” is mentioned in both Document [1] and [4], and <span class="smallcaps">Mirage</span> finds both occurrences as salient towards the prediction of the same entity in the output. Similarly, in <a href="#tbl-case-study-6" class="quarto-xref">Table&nbsp;<span>A.8</span></a>, the generated word `Document’ is attributed to the previous mentions of the same word in the context. In both cases, when moving from token-level to sentence-level AA, this dependence would result in wrong AA according to NLI, since the documents are not entailing the answer, but rather making a specific token more likely. These cases reflect the possible discrepancy between AA intended as logical entailment and actual context usage during generation. Future work could explore more elaborate ways to aggregate granular information at sentence level while preserving faithfulness to context usage.</p>
<div id="tbl-case-study-5" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<div aria-describedby="tbl-case-study-5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="fullwidthtable leftalign table" data-quarto-postprocess="true">
<tbody>
<tr class="bottomrule odd">
<td><span class="smallcaps">Input: Prompt + Retrieved docs (N=5) + Query</span></td>
</tr>
<tr class="even">
<td><strong>Document [1]</strong> (Title: Why Do Airlines Sell More Tickets Than The Aircraft’s Capacity? » Science ABC): […] They know that some people simply won’t show up for their appointments […] To account for this discrepancy, where the flight would have to fly with some very expensive seats empty, they decide to opt for a more profitable strategy. Assuming that out of the maximum capacity of 200 seats only 185 show up for the flight, this leaves 15 seats available. The airline could try to sell these seats quickly to avoid losses, but this rarely happens. What the airline does instead is try to sell 220 seats in advance.</td>
</tr>
<tr class="odd">
<td><strong>Document [2]</strong> […]</td>
</tr>
<tr class="even">
<td><strong>Document [3]</strong> […]</td>
</tr>
<tr class="odd">
<td><strong>Document [4]</strong> (Title: Why Do Airlines Sell More Tickets Than The Aircraft’s Capacity? » Science ABC): your own interests, as the airlines have clearly looked after theirs. First of all, if the airline is offering you a seat on a different flight, check if that seat is definitely available. If it is also full and it looks like you might be bumped yet again, you might as well be stranded! If the airline is offering compensation, such as free meals, hotel costs, and transportation between the airport and the hotel, look for the most profitable outcome. The airline might offer you vouchers for future flights, but since airline employees are given guidelines for negotiation, you might</td>
</tr>
<tr class="even">
<td><strong>Document [5]</strong> […]</td>
</tr>
<tr class="midrule odd">
<td><strong>Query</strong>: Why are airlines able to sell more seats than are available on a flight?</td>
</tr>
<tr class="bottomrule even">
<td><span class="smallcaps">Answer attribution results</span></td>
</tr>
<tr class="odd">
<td><strong>Self-citation</strong>: […] According to a report from Science ABC <span class="light-content" style="color: blue;">[1]</span>, airlines assume that out of the maximum capacity of 200 seats, only 185 will actually board the aircraft. To avoid empty seats and potential losses, airlines opt to sell up to 220 seats in advance <span class="light-content" style="color: blue;">[1]</span>. […]</td>
</tr>
<tr class="even">
<td><strong><span class="smallcaps">Mirage</span></strong>: […] According to a report from <span class="light-content" style="border-radius: 0.2rem; padding: 0 0.2rem 0 0.2rem;background-color: yellow;">Science ABC</span><span class="math inline">\(^{(1)(4)}\)</span>, airlines assume <span class="light-content" style="border-radius: 0.2rem; padding: 0 0.2rem 0 0.2rem;background-color: yellow;">that out</span><span class="math inline">\(^{(1)}\)</span> of <span class="light-content" style="border-radius: 0.2rem; padding: 0 0.2rem 0 0.2rem;background-color: yellow;">the maximum capacity</span><span class="math inline">\(^{(1)}\)</span> of <span class="light-content" style="border-radius: 0.2rem; padding: 0 0.2rem 0 0.2rem;background-color: yellow;">200 seats</span><span class="math inline">\(^{(1)}\)</span>, only <span class="light-content" style="border-radius: 0.2rem; padding: 0 0.2rem 0 0.2rem;background-color: yellow;">185</span><span class="math inline">\(^{(1)}\)</span> will actually board the aircraft. <span class="light-content" style="color: blue;">[1][4]</span> […]</td>
</tr>
<tr class="odd">
<td><strong>NLI (<span class="smallcaps">True</span> model)</strong>: Only <span class="light-content" style="color: blue;">[1]</span> entails the answer sentence.</td>
</tr>
</tbody>
</table>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-tbl" id="tbl-case-study-5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;A.7: Example of counterintuitive <span class="smallcaps">Mirage</span> attribution: the generation is grounded to Document [4] because the named entity <code>Science ABC</code> is made more probable by the occurrence of the same named entity <code>Science ABC</code>. However, Document [4] does not logically entail the answer.
</figcaption>
</figure>
</div>
<div id="tbl-case-study-6" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<div aria-describedby="tbl-case-study-6-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="fullwidthtable leftalign table" data-quarto-postprocess="true">
<tbody>
<tr class="bottomrule odd">
<td><span class="smallcaps">Input: Prompt + Retrieved docs (N=5) + Query</span></td>
</tr>
<tr class="even">
<td><strong>Document [1]</strong> (Title: Why Do Airlines Sell More Tickets Than The Aircraft’s Capacity? » Science ABC): board the aircraft. They know that some people simply won’t show up for their appointments (just like at hospitals, hotels, restaurants etc.). To account for this discrepancy, where the flight would have to fly with some very expensive seats empty, they decide to opt for a more profitable strategy. Assuming that out of the maximum capacity of 200 seats only 185 show up for the flight, this leaves 15 seats available. The airline could try to sell these seats quickly to avoid losses, but this rarely happens. What the airline does instead is try to sell 220 seats in advance.</td>
</tr>
<tr class="odd">
<td><strong>Document [2]</strong> […]</td>
</tr>
<tr class="even">
<td><strong>Document [3]</strong> […]</td>
</tr>
<tr class="odd">
<td><strong>Document [4]</strong> (Title: Why Do Airlines Sell More Tickets Than The Aircraft’s Capacity? » Science ABC): your own interests, as the airlines have clearly looked after theirs. First of all, if the airline is offering you a seat on a different flight, check if that seat is definitely available. If it is also full and it looks like you might be bumped yet again, you might as well be stranded! If the airline is offering compensation, such as free meals, hotel costs, and transportation between the airport and the hotel, look for the most profitable outcome. The airline might offer you vouchers for future flights, but since airline employees are given guidelines for negotiation, you might</td>
</tr>
<tr class="even">
<td><strong>Document [5]</strong> […]</td>
</tr>
<tr class="midrule odd">
<td><strong>Query</strong>: Why are airlines able to sell more seats than are available on a flight?</td>
</tr>
<tr class="bottomrule even">
<td><span class="smallcaps">Answer attribution results</span></td>
</tr>
<tr class="odd">
<td><strong>Self-citation</strong>: […] According to a source in Document <span class="light-content" style="color: blue;">[1]</span>, airlines assume that not all passengers will show up for their flights, leaving some seats empty. […]</td>
</tr>
<tr class="even">
<td><strong><span class="smallcaps">Mirage</span></strong>: […] According to a source in <span class="light-content" style="border-radius: 0.2rem; padding: 0 0.2rem 0 0.2rem;background-color: yellow;">Document</span><span class="math inline">\(^{(4)}\)</span>, airlines <span class="light-content" style="border-radius: 0.2rem; padding: 0 0.2rem 0 0.2rem;background-color: yellow;">assume that not</span><span class="math inline">\(^{(1)}\)</span> all passengers will show up for their flights, leaving some seats empty. <span class="light-content" style="color: blue;">[1][4]</span> […]</td>
</tr>
<tr class="odd">
<td><strong>NLI (<span class="smallcaps">True</span> model)</strong>: Only <span class="light-content" style="color: blue;">[1]</span> entails the answer sentence.</td>
</tr>
</tbody>
</table>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-tbl" id="tbl-case-study-6-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;A.8: Example of counterintuitive <span class="smallcaps">Mirage</span> attribution: Document [4] is attributed by <span class="smallcaps">Mirage</span> due to the repetition of the keyword `Document’.
</figcaption>
</figure>
</div>


<div id="refs" class="references csl-bib-body" role="list" style="display: none">
<div id="ref-gao-etal-2023-enabling" class="csl-entry" role="listitem">
Tianyu Gao, Howard Yen, Jiatong Yu, and Danqi Chen. 2023. <a href="https://doi.org/10.18653/v1/2023.emnlp-main.398">Enabling large language models to generate text with citations</a>. In Houda Bouamor, Juan Pino, and Kalika Bali, editors, <em>Proceedings of the 2023 conference on empirical methods in natural language processing</em>, pages 6465–6488, Singapore. Association for Computational Linguistics.
</div>
<div id="ref-jiang-etal-2023-mistral" class="csl-entry" role="listitem">
Albert Q. Jiang, Alexandre Sablayrolles, Arthur Mensch, Chris Bamford, Devendra Singh Chaplot, Diego de las Casas, Florian Bressand, Gianna Lengyel, Guillaume Lample, Lucile Saulnier, Lélio Renard Lavaud, Marie-Anne Lachaux, Pierre Stock, Teven Le Scao, Thibaut Lavril, Thomas Wang, Timothée Lacroix, and William El Sayed. 2023. <a href="http://arxiv.org/abs/2310.06825">Mistral 7B</a>.
</div>
<div id="ref-levy-etal-2021-collecting-large" class="csl-entry" role="listitem">
Shahar Levy, Koren Lazar, and Gabriel Stanovsky. 2021. <a href="https://doi.org/10.18653/v1/2021.findings-emnlp.211">Collecting a large-scale gender bias dataset for coreference resolution and machine translation</a>. In Marie-Francine Moens, Xuanjing Huang, Lucia Specia, and Scott Wen-tau Yih, editors, <em>Findings of the association for computational linguistics: EMNLP 2021</em>, pages 2470–2480, Punta Cana, Dominican Republic. Association for Computational Linguistics.
</div>
<div id="ref-muller-etal-2023-evaluating" class="csl-entry" role="listitem">
Benjamin Muller, John Wieting, Jonathan Clark, Tom Kwiatkowski, Sebastian Ruder, Livio Soares, Roee Aharoni, Jonathan Herzig, and Xinyi Wang. 2023. <a href="https://doi.org/10.18653/v1/2023.emnlp-main.10">Evaluating and modeling attribution for cross-lingual question answering</a>. In Houda Bouamor, Juan Pino, and Kalika Bali, editors, <em>Proceedings of the 2023 conference on empirical methods in natural language processing</em>, pages 144–157, Singapore. Association for Computational Linguistics.
</div>
<div id="ref-post-2018-call" class="csl-entry" role="listitem">
Matt Post. 2018. <a href="https://doi.org/10.18653/v1/W18-6319">A call for clarity in reporting <span>BLEU</span> scores</a>. In Ondřej Bojar, Rajen Chatterjee, Christian Federmann, Mark Fishel, Yvette Graham, Barry Haddow, Matthias Huck, Antonio Jimeno Yepes, Philipp Koehn, Christof Monz, Matteo Negri, Aurélie Névéol, Mariana Neves, Matt Post, Lucia Specia, Marco Turchi, and Karin Verspoor, editors, <em>Proceedings of the third conference on machine translation: Research papers</em>, pages 186–191, Brussels, Belgium. Association for Computational Linguistics.
</div>
<div id="ref-tiedemann-2020-tatoeba" class="csl-entry" role="listitem">
Jörg Tiedemann. 2020. <a href="https://aclanthology.org/2020.wmt-1.139/">The tatoeba translation challenge <span>–</span> realistic data sets for low resource and multilingual <span>MT</span></a>. In Loïc Barrault, Ondřej Bojar, Fethi Bougares, Rajen Chatterjee, Marta R. Costa-jussà, Christian Federmann, Mark Fishel, Alexander Fraser, Yvette Graham, Paco Guzman, Barry Haddow, Matthias Huck, Antonio Jimeno Yepes, Philipp Koehn, André Martins, Makoto Morishita, Christof Monz, Masaaki Nagata, Toshiaki Nakazawa, et al., editors, <em>Proceedings of the fifth conference on machine translation</em>, pages 1174–1182, Online. Association for Computational Linguistics.
</div>
<div id="ref-tunstall-etal-2023-zephyr" class="csl-entry" role="listitem">
Lewis Tunstall, Edward Beeching, Nathan Lambert, Nazneen Rajani, Kashif Rasul, Younes Belkada, Shengyi Huang, Leandro von Werra, Clémentine Fourrier, Nathan Habib, Nathan Sarrazin, Omar Sanseviero, Alexander M. Rush, and Thomas Wolf. 2024. <a href="https://openreview.net/forum?id=aKkAwZB6JV#discussion">Zephyr: Direct distillation of LM alignment</a>. In <em>Proceedings of the 1st conference on language modeling (COLM)</em>.
</div>
</div>
</section>
</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p><a href="https://github.com/rudinger/winogender-schemas/blob/master/data/occupations-stats.tsv">https://github.com/rudinger/winogender-schemas</a> (<code>bls_pct_female</code> column)<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>Note that we remove citation tags in self-citation generated answers and use MIRAGE to attribute the resulting answers, as introduced in <a href="chap-5-mirage.html#sec-chap5-eli5-evaluation" class="quarto-xref"><span>Section 5.5</span></a>.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../chapters/references.html" class="pagination-link" aria-label="Bibliography">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Bibliography</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../chapters/appendix-b.html" class="pagination-link" aria-label="Conditioning Generation for Personalized Machine Translation">
        <span class="nav-page-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Conditioning Generation for Personalized Machine Translation</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>© 2025 Gabriele Sarti. All rights reserved.</p>
</div>   
    <div class="nav-footer-center">
<p><a href="https://www.rug.nl/?lang=en"><img src="../figures/logos/rug_eng_red.png" class="img-fluid" style="width: auto; height: 35px; padding-left: 10px; padding-right: 10px; margin-bottom:5px;"></a> <a href="https://www.rug.nl/research/clcg/?lang=en"><img src="../figures/logos/clcg.png" class="img-fluid" style="width: auto; height: 35px; padding-left: 10px; padding-right: 10px; margin-bottom:5px;"></a> <a href="https://projects.illc.uva.nl/indeep/"><img src="../figures/logos/indeep_logo_horizontal.png" class="img-fluid" style="width: auto; height: 35px; padding-left: 10px; padding-right: 10px; margin-bottom:5px;"></a> <a href="https://www.rug.nl/research/clcg/research/cl/?lang=en"><img src="../figures/logos/gronlp.png" class="img-fluid" style="width: auto; height: 35px; padding-left: 10px; padding-right: 10px; margin-bottom:5px;"></a></p>
</div>
    <div class="nav-footer-right">
<p>Written with <a href="https://quarto.org/">Quarto</a>.</p>
</div>
  </div>
</footer>
    <script type="text/javascript">
    (function(d) {
      d.querySelectorAll(".pseudocode-container").forEach(function(el) {
        let pseudocodeOptions = {
          indentSize: el.dataset.indentSize || "1.2em",
          commentDelimiter: el.dataset.commentDelimiter || "//",
          lineNumber: el.dataset.lineNumber === "true" ? true : false,
          lineNumberPunc: el.dataset.lineNumberPunc || ":",
          noEnd: el.dataset.noEnd === "true" ? true : false,
          titlePrefix: el.dataset.captionPrefix || "Algorithm"
        };
        pseudocode.renderElement(el.querySelector(".pseudocode"), pseudocodeOptions);
      });
    })(document);
    (function(d) {
      d.querySelectorAll(".pseudocode-container").forEach(function(el) {
        let captionSpan = el.querySelector(".ps-root > .ps-algorithm > .ps-line > .ps-keyword")
        if (captionSpan !== null) {
          let captionPrefix = el.dataset.captionPrefix + " ";
          let captionNumber = "";
          if (el.dataset.pseudocodeNumber) {
            captionNumber = el.dataset.pseudocodeNumber + " ";
            if (el.dataset.chapterLevel) {
              captionNumber = el.dataset.chapterLevel + "." + captionNumber;
            }
          }
          captionSpan.innerHTML = captionPrefix + captionNumber;
        }
      });
    })(document);
    </script>
  




</body></html>